---
tags:
  - Программирование/Linux
up: "[[Linux]]"
---

# Какие бывают права

У каждого файла есть 3 байта под права.
- **---** - нет прав, совсем;
- **--x** - разрешено только выполнение файла, как программы но не изменение и не чтение;
- **-w-** - разрешена только запись и изменение файла;
- **-wx** - разрешено изменение и выполнение, но в случае с каталогом, вы не можете посмотреть его содержимое;
- **r--** - права только на чтение;
- **r-x** - только чтение и выполнение, без права на запись;
- **rw-** - права на чтение и запись, но без выполнения;
- **rwx** - все права;

Рассмотрим пример: 
```bash
[root@server1 home]#ls -l
total 8
drwx------. 3  bob            bob            74     Feb   6   10:13 bob
```

![][https://younglinux.info/sites/default/files/images/linux-bash/rwxlinux.png]

# Что такое группы

```bash
alex@ubu:~$ id
uid=1000(alex) gid=1000(alex) groups=1000(alex),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),116(lxd)
```

В выводе мы видим что пользователь **alex**:

- имеет user id (**uid**) = 1000;
- входит в группу **alex**, которая имеет group id (**gid**) = 1000;
- также он входит в другие группы, причем список групп для ubuntu и для debian отличается;
- и у каждой группы есть номер (**gid**).

Для системы номер пользователя или группы важнее чем его имя!

- **uid** — user id, номер пользователя;
- **gid** — group id, номер группы.

# groupadd 

```bash
$ groupadd опции имя_группы
```

*  **-f** - если группа уже существует, то утилита возвращает положительный результат операции;
- **-g** - установить значение идентификатора группы GID вручную;
- **-K** - изменить параметры по умолчанию автоматической генерации GID;
- **-o** - разрешить добавление группы с неуникальным GID;
- **-p** - задаёт пароль для группы;
- **-r** - указывает, что группа системная;
- **-R** - позволяет изменить корневой каталог.


# useradd

```bash
$ useradd опции имя_пользователя
```

- **-b** - базовый каталог для размещения домашнего каталога пользователя, по умолчанию /home;
- **-c** - комментарий к учетной записи;
- **-d** - домашний каталог, в котором будут размещаться файлы пользователя;
- **-e** - дата, когда учетная запись пользователя будет заблокирована, в формате ГГГГ-ММ-ДД;
- **-f** - заблокировать учетную запись сразу после создания;
- **-g** - основная группа пользователя;
- **-G** - список дополнительных групп;
- **-k** - каталог с шаблонами конфигурационных файлов;
- **-l** - не сохранять информацию о входах пользователя в lastlog и faillog;
- **-m** - создавать домашний каталог пользователя, если он не существует;
- **-M** - не создавать домашнюю папку;
- **-N** - не создавать группу с именем пользователя;
- **-o** - разрешить создание пользователя linux с неуникальным идентификатором UID;
- **-p** - задать пароль пользователя;
- **-r** - создать системного пользователя, не имеет оболочки входа, без домашней директории и с идентификатором до SYS_UID_MAX;
- **-s** - командная оболочка для пользователя;
- **-u** - идентификатор для пользователя;
- **-D** - отобразить параметры, которые используются по умолчанию для создания пользователя. Если вместе с этой опцией задать еще какой-либо параметр, то его значение по умолчанию будет переопределено.

# groupdel

```bash
$ groupadd опции имя_группы
```

- **-f** - если группа уже существует, то утилита возвращает положительный результат операции;
- **-g** - установить значение идентификатора группы GID вручную;
- **-K** - изменить параметры по умолчанию автоматической генерации GID;
- **-o** - разрешить добавление группы с неуникальным GID;
- **-p** - задаёт пароль для группы;
- **-r** - указывает, что группа системная;
- **-R** - позволяет изменить корневой каталог.
# userdel

```bash
$ userdel параметры пользователь
```

- **-f, --force** - принудительное удаление, даже если пользователь еще залогинен.
- **-r, --remove** - удалить домашнюю директорию пользователя и его файлы в системе.
- **-Z** - удалить все SELinux объекты для этого пользователя.
# groupmod

```bash
groupadd [options] GROUP
```

В качестве обязательного параметра - `GROUP` ей передается имя группы.

- `-g, --gid GID`: устанавливает GID для новой группы
- `-p, --password ПАРОЛЬ`: применяет пароль для новой группы
- `-U, --users ПОЛЬЗОВАТЕЛИ`: задает список пользователей-членов этой группы
# usermod

```bash
$ usermod опции имя_пользователя
```

- -**a**, **--append** – добавить пользователя в одну или несколько дополнительных групп. Опция будет работать только вместе с опцией **-G**.
- -**b**, **--badnames** – разрешить использование имен, которые не соответствуют стандартам.
- -**d**, **--home** – указать новое местоположение домашнего каталога пользователя. При использовании опции **-m** содержимое текущего домашнего каталога будет перемещено на новое место.
- -**e**, **--expiredate** – указать дату, при наступлении которой учетная запись будет отключена. Дата вводится в формате ГГГГ-ММ-ДД. Если использовать эту опцию без указания даты, то отключение пользователя будет отменено.
- -**f**, **--inactive** – установить количество дней для блокировки пользователя, которое должно пройти после устаревания пароля. При значении -1 опция блокировки отключается, а при значении 0 блокировка случится сразу же после устаревания.
- -**g**, **--gid** – выбрать новую основную группу для пользователя и для файлов в его домашнем каталоге. Нужно задать имя или номер новой группы.
- -**G**, **--groups** – указать список дополнительных групп, в которые должен входить пользователь. Между собой группы разделяются запятой. Если пользователь входит в дополнительную группу, которая не была указана в списке, то он будет из нее удалён. Но при использовании опции **-a** можно добавлять новые дополнительные группы, не удаляя старые.
- -**l**, **--login** – изменить имя пользователя на новое. Данная опция не затрагивает никакие другие данные. А значит, название домашнего каталога и почты придется изменять вручную, чтобы они совпадали с новым именем пользователя.
- -**L**, **--lock** – заблокировать пароль пользователя. Эта опция помещает символ ! (восклицательный знак) перед паролем в зашифрованном виде, отключая его. Данную опцию нельзя использовать с **-p** и **-U**.
- -**m**, **--move-home** – изменить местоположение домашнего каталога пользователя. Опция будет работать только вместе с **-d**. Утилита попытается обновить права собственности на файлы и скопировать режимы, ACL и расширенные атрибуты.
- -**o**, **--non-unique** – разрешить заменить идентификационный номер пользователя на не уникальное значение. Работает в паре с опцией **-u**.
- -**p**, **--password** – изменить пароль в зашифрованном виде.
- -**R**, **--root** – выполнить chroot в указанный каталог и использовать его вместо корневого каталога / с хранящимися в нем конфигурационными файлами.
- -**s**, **--shell** – указать новую командную оболочку shell для пользователя. При использовании опции **-s** с пустым значением будет выбрана оболочка по умолчанию.
- -**u**, **--uid** – изменить параметр UID (числовой идентификатор пользователя). Данные изменения автоматически применятся к почтовому ящику и содержимому домашнего каталога. Для остальных файлов UID придется изменять вручную.
- -**U**, **--unlock** – разблокировать пароль пользователя. Данная опция убирает символ ! (восклицательный знак) перед паролем в зашифрованном виде, разрешая использовать его для входа. Не сработает с **-p** и **-L**.
# openssl

```bash
openssl _command_ [ _options_ ... ] [ _parameters_ ... ]

openssl no-_XXX_ [ _options_ ]
```

Тут большая документация, лучше посмотреть на [сайте](https://docs.openssl.org/master/man1/openssl/)
# chage

В Linux команда `chage` используется для просмотра и изменения информации об истечении срока действия пароля пользователя.

```bash
$ chage [параметры] ПОЛЬЗОВАТЕЛЬ
```

- -d, --lastday ПОСЛ_ДЕНЬ Установить последний день смены пароля в ПОСЛ_ДЕНЬ

- -E, --expiredate ДАТА_УСТ Установить дату окончания действия учётной записи в ДАТА_УСТ

- -i, --iso8601 Для вывода дат использовать YYYY-MM-DD

- -I, --inactive НЕАКТИВНОСТЬ Установить неактивность пароля после устаревания в значение НЕАКТИВНОСТЬ

- -l, --list Показать «возраст» учётной записи

- -m, --mindays МИН_ДНЕЙ Установить минимальное число дней перед сменой пароля в МИН_ДНЕЙ

- -M, --maxdays MAX_DAYS Установить максимальное количество дней до смены пароля на MAX_DAYS

- -R, --root КАТ_CHROOT Каталог, в который выполняется chroot

- -P, --prefix PREFIX_DIR Префикс каталога

- -W, --warndays ПРЕДУП_ДНЕЙ Установить количество дней с выдачей предупреждения в ПРЕДУП_ДНЕЙ

- -h, --help Показать данное сообщение и закончить работу
# chmod 

```bash
$ chmod опции права /путь/к/файлу
```

[[#Какие бывают права]]]

- **-R** или **—recursive**: рекурсивно изменяет права доступа для всех файлов и подкаталогов внутри указанного каталога.
- **-f** или **—silent**, **—quiet**: подавляет вывод сообщений об ошибках или предупреждениях.
- **-v** или **—verbose**: выводит подробный отчет о каждом изменении прав доступа.
- **-c** или **—change**: ключ действует аналогично ключу **—verbose**. Он выводит информацию только если с файлом или директорией были произведены какие-либо действия.
### Символьная нотация

Синтаксис у символьной нотации следующий:
```bash
chmod [ugoa] [+-=] [rwx] файл(ы)
```

- [ugoa] указывает, к кому применяются изменения:
    - u: владелец файла.
    - g: группа файла.
    - o: остальные пользователи (не владелец и не входящие в группу).
    - a: все (при использовании заменяет собой ugo).

- [+-=] определяет, что нужно сделать с разрешениями:
    - +: добавить разрешение.
    - -: удалить разрешение.
    - =: установить разрешение точно (заменить текущие разрешения).

- — [rwx] представляет собой комбинацию символов `r`, `w` и `x`, обозначающих разрешения:
    - r: разрешение на чтение.
    - w: разрешение на запись.
    - x: разрешение на выполнение.

Примеры использования символьной нотации:

- chmod u+x файл — добавить право выполнения для владельца файла.
- chmod go-rw файл — удалить право чтения и записи для группы и остальных пользователей.
- chmod a=rwx файл — установить полные права (чтение, запись и выполнение) для всех.

### Числовая нотация

Числовая нотация состоит из трех цифр, где каждая цифра представляет разрешения для владельца, группы и остальных пользователей соответственно. Каждая цифра состоит из суммы разных значений, присвоенных разным разрешениям:

- 4 — разрешение на чтение (read).
- 2 — разрешение на запись (write).
- 1 — разрешение на выполнение (execute).
- 0 — отсутствие разрешения.

Для установки конкретных разрешений, сложите соответствующие значения:

- Если вы хотите только разрешение на чтение, используйте 4.
- Если вы хотите разрешение на чтение и запись, сложите 4 и 2, что даст 6.
- Если вы хотите разрешение на чтение и выполнение, сложите 4 и 1, что даст 5.
- Если вы хотите разрешение на чтение, запись и выполнение, сложите 4, 2 и 1, что даст 7.
- 
Рассмотрим примеры использования числовой нотации. Например, вы можете выполнить команды:

```bash
chmod 644 myfile
```
# chgrp

```bash
$ chgrp [параметры] новая_группа имя_файла
```

- **-h** – работать непосредственно с самими символьными ссылками, а не с файлами, на которые они ссылаются;
- **--dereference** – работать с файлами, а не самими символьными ссылками. Используется по умолчанию;
- **-R** – рекурсивная обработка каталога со всем его содержимым;
- **-H** – перейти по символической ссылке и изменить атрибуты файла/каталога. Сама ссылка остаётся без изменений. Используется вместе с параметром -R;
- **-L** - перейти по символической ссылке и продолжить рекурсивную обработку. Сама ссылка остаётся без изменений. Используется вместе с параметром -R;
- **-P** – при встрече с символьной ссылкой обрабатывать только её. Используется вместе с параметром **-R**, является значением по умолчанию;
- **--reference=имя_образца** – использовать группу образца. Используется вместо **новая_группа**;
- **-c** – при обработке выводить только изменения;
- **-v** – выводить информацию о каждом обработанном файле.

### Использование команды chgrp

Следующая команда меняет группу на www-data для файла file в текущей папке:

```bash
sudo chgrp www-data file.txt
```
# chown

```bash
$ chown пользователь опции /путь/к/файлу
```

В поле пользователь надо указать пользователя, которому мы хотим передать файл. Также можно указать через двоеточие группу, например, **пользователь:группа**. Тогда изменится не только пользователь, но и группа. Вот основные опции, которые могут вам понадобиться:

- **-c, --changes** - подробный вывод всех выполняемых изменений;
- **-f, --silent, --quiet** - минимум информации, скрыть сообщения об ошибках;
- **--dereference** - изменять права для файла к которому ведет символическая ссылка вместо самой ссылки (поведение по умолчанию);
- **-h, --no-dereference** - изменять права символических ссылок и не трогать файлы, к которым они ведут;
- **--from** - изменять пользователя только для тех файлов, владельцем которых является указанный пользователь и группа;
- **-R, --recursive** - рекурсивная обработка всех подкаталогов;
- **-H** - если передана символическая ссылка на директорию - перейти по ней;
- **-L** - переходить по всем символическим ссылкам на директории;
- **-P** - не переходить по символическим ссылкам на директории (по умолчанию).
# groups

Посмотреть группы linux, в которых состоит пользователь можно командой:
```bash
$ groups
```

# id


**id** — это команда в Linux, которая выводит имена пользователей и групп вместе с их числовыми идентификаторами (UID или GID) текущего пользователя или любого указанного пользователя в системе.

**Синтаксис**: 
```bash
id [OPTIONS] [USERNAME]
```

**Некоторые опции команды**:

- **-g**: выводит только эффективный идентификатор группы пользователя.
- **-G**: выводит все идентификаторы групп, связанных с пользователем.
- **-n**: выводит имена вместо числовых идентификаторов.
- **-r**: показывает реальный идентификатор вместо эффективного. 
- **-u**: выводит только эффективный идентификатор пользователя.
- **–help**: выводит сообщения о помощи для команды id и выходит. 
- **-version**: показывает информацию о версии и выходит. [
