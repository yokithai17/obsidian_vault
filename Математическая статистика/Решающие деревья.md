---
tags:
  - Математика/Матстат
  - Математика
up: "[[Математическая статистика]]"
---

# Основы

#### §1.1 Определение

Рассмотрим бинарное дерево, в котором: 
- каждой внутренней вершине $v$ приписана функция $\beta_{v} : \mathbb{X} \rightarrow \{0, 1\}$; 
-  каждой листовой вершине $v$ приписана метка класса $c_{v} \in Y$. 
Рассмотрим теперь алгоритм $a(x)$, который стартует из корневой вершины $v_{0}$ и вычисляет значение функции $β_{v_{0}}$ . Если оно равно нулю, то алгоритм переходит в левую дочернюю вершину, иначе в правую, вычисляет значение предиката в новой вершине и делает переход или влево, или вправо. Процесс продолжается, пока не будет достигнута листовая вершина; алгоритм возвращает тот класс, который приписан этой вершине. Такой алгоритм называется бинарным решающим деревом.

#### §1.2 Построение деревьев

Опишем простейший алгоритм построения бинарного решающего дерева. Начнем со всей обучающей выборки $X^{l}$ и найдем наилучшее ее разбиение на две части $R_{1}(j,s) = \{x | x_{j} \le s\}$ и  $R_{2}(j,s) = \{x | x_{j} \gt s\}$ с точки зрения заранее заданного критерия $Q(X,j,x)$. Найдя наилучшие значения $j$ и $s$, создадим корневую вершину дерева, поставив ей в соответствие функцию $[x_{j} \le s]$. Объекты разобьются на две части — одни попадут в левое поддерево, другие в правое. Для каждой из этих подвыборок повторим процедуру, построив дочерние вершины для корневой, и так далее. Если после очередного разбиения выборки на две части в одной из половин окажутся объекты лишь одного класса, то создадим листовую вершину, которой будет соответствовать класс попавших в нее объектов.

#### §1.3 Критерии информативности

При построении дерева необходимо **задать критерий информативности** $Q(X,j,s)$, на основе которого осуществляется разбиение выборки на каждом шаге. Рассмотрим различный варианты таких критериев.

Пусть $R_{m}$ — множество объектов обучающей выборки, попавших в вершину $m$.

Обозначим через $p_{mk}$ долю объектов класса $k \ (k \in \{1,\dots,K\})$, попавших в вершину $m$

$$p_{mk} = \dfrac{1}{N_{m}}\sum_{x_{i} \in R_{m}}[y_{i}=k]$$

Где $N_{m} = |R_{m}|$. Через $k_{m}$ обозначим класс, чьих представителей оказалось больше всего среди объектов, попавших в вершину $m : k_{m} = \underset{k}{argmax \ p_{mk}}$    
#### 1.3.1 Ошибка классификации

Вычислим долю объектов из $R_{m}$ которые были бы неправильно классифицированы, если бы вершина $m$ была листовой и относила все объекты к классу $k_{m}$:
$$F_{E}(R_{m})=\dfrac{1}{N_{m}}\sum_{x_{i} \in R_{m}}[y_{i}\ne k]$$
Критерий информативности при ветвлении вершины $m$ определяется как
$$Q_{E}(R_{m},j,s)=F_{E}(R_{m})-\dfrac{N_{l}}{N_{m}}F_{E}(R_{l})-\dfrac{N_{r}}{N_{m}}F_{E}(R_{r})$$
где $l$ и $r$ — индексы левой и правой дочерних вершин.
#### 1.3.2 Индекс Джини

^69958e

Функционал имеет вид
$$F_{G}(R_{m})=\sum_{k \ne k^{`}}p_{mk}p_{mk^{1}}$$
Критерий информативности определяется так же, как и в предыдущем случае:

$$Q_{E}(R_{m},j,s)=F_{E}(R_{m})-\dfrac{N_{l}}{N_{m}}F_{E}(R_{l})-\dfrac{N_{r}}{N_{m}}F_{E}(R_{r})$$
**Задача 1.2** Покажите, что индекс Джини $F_{G}(R_{m})$ также можно записать в виде $F_{G}(R_{m}) = \sum_{k=1}^{K}p_{mk}(1-p_{mk})=1 - \sum_{k=1}^{K}p_{mk}^{2}$.

**Решение.**
$$\sum_{k \neq k'}p_{mk^{`}}p_{mk}=\sum_{k=1}^{K}p_{mk}\sum_{k`\neq k}p_{km^{'}}=\sum_{k=1}^{K}p_{mk}(1-p_{mk})$$